<header role="banner">
  <nav class="mobile-nav show-on-mobiles">
    {% include primary-nav-items.html %}
  </nav>
  <div class="grid">
    <div class="unit one-fifth hide-on-mobiles">
      <h1>
        <a href="{{site.baseurl}}/">
          <img src="{{site.baseurl}}/img/logo-2x.png" width="115" height="115" alt="behaviac Logo">
        </a>
      </h1>
    </div>
    <nav class="main-nav unit four-fifths hide-on-mobiles">
    <a href="http://tencentopen.github.io/">
      <img src="{{site.baseurl}}/img/tencentOpen_logo.png" class="tencentOpen_logo">
    </a>
      {% include primary-nav-items.html %}
    </nav>
  </div>
</header>

<script src="{{site.baseurl}}/js/jquery.js"></script>
<script src="{{site.baseurl}}/js/lunr.zh.min.js"></script>
<script src="{{site.baseurl}}/search.js"></script>
<script>
$(function() {
  $("#query_btn1").click(function()
  {
   
  });
  $("#query_btn").click(function()
  {
    search();
  });
  $("#query_input").keypress(function(e) {
    if(e.which == 13) {
      e.preventDefault();
      search();
    }
    
  });

  $("#query_input").change(function(e) {
    
    if($("#query_input").val()=="")
    {
      $("#query_result").html("");
      return ;
    }
  });
  
})
function search() {
  if($("#query_input").val()=="")
    {
      $("#query_result").html("");
      return ;
    }
    /*****
    * if user use multiple keys to search, then at first we should show the article relative all keys in front of results.
    * modify: Quinn Pan<pjkui@qq.com>
    * time: 2015-12-10 15:50:35
    */
    var query_str = $("#query_input").val();//get the query string
    var query_str_and  =  query_str.split(/\s+/g).join('.*');
    var query_str_or   =  query_str.split(/\s+/g).join('|');
    var re_and  = new RegExp(query_str_and ,"i"); //construct regular expression, and logical query
    var re_or   = new RegExp(query_str_or ,"i");//or logical  query 
    var result_str="";//save the search result
    var record_ids=[];
    for(var doc in docs)
    {
      if(docs[doc].title.search(re_and)!=-1 || docs[doc].id.search(re_and)!= -1 || docs[doc].content.search(re_and)!= -1)
      {
      id=docs[doc].id;
      title=docs[doc].title.substr(0,40);
      content=docs[doc].content.substr(0,40);
      result_str+=
      "<p class=\"line\">"+
          "<span class=\"path\"><a href=\""+id+"\" target=\"_blank\">"+title+"</a></span>"+
          "<span class=\"prompt\">:</span>"+
          "<span class=\"command\">"+content+"</span>"+
      "</p>";
      }
      record_ids.push(doc);//add record in record_ids
    }
    for(var doc in docs)
    {
      //if the doc is doesn't record the add it 
      if(record_ids.indexOf(doc)==-1 &&(docs[doc].title.search(re_or)!=-1 || docs[re_or].id.search(re_or)!= -1 || docs[doc].content.search(re_or)!= -1))
      {
      id=docs[doc].id;
      title=docs[doc].title.substr(0,40);
      content=docs[doc].content.substr(0,40);
      result_str+=
      "<p class=\"line\">"+
          "<span class=\"path\"><a href=\""+id+"\" target=\"_blank\">"+title+"</a></span>"+
          "<span class=\"prompt\">:</span>"+
          "<span class=\"command\">"+content+"</span>"+
      "</p>";
      }
      record_ids.push(doc);//add record in record_ids
    }
  $("#query_result").html(result_str);
  if(result_str.length <= 0) {
    result_str = 
      "<p class=\"line\">"+
          "<span class=\"path\">Result</span>"+
          "<span class=\"prompt\">:</span>"+
          "<span class=\"command\">Not Found!</span>"+
      "</p>";
    $("#query_result").html(result_str);
  }
}

function gotoTop(min_height){
    //预定义返回顶部的html代码，它的css样式默认为不显示
    var gotoTop_html = '<div id="gotoTop">返回顶部</div>';
    //将返回顶部的html代码插入页面上id为page的元素的末尾 
    // $("#page").append(gotoTop_html);
    $("#gotoTop").click(//定义返回顶部点击向上滚动的动画
        function(){$('html,body').animate({scrollTop:0},700);
    }).hover(//为返回顶部增加鼠标进入的反馈效果，用添加删除css类实现
        function(){$(this).addClass("hover");},
        function(){$(this).removeClass("hover");
    });
    //获取页面的最小高度，无传入值则默认为600像素
    min_height ? min_height = min_height : min_height = 600;
    //为窗口的scroll事件绑定处理函数
    $(window).scroll(function(){
        //获取窗口的滚动条的垂直位置
        var s = $(window).scrollTop();
        //当窗口的滚动条的垂直位置大于页面的最小高度时，让返回顶部元素渐现，否则渐隐
        if( s > min_height){
            $("#gotoTop").fadeIn(100);
        }else{
            $("#gotoTop").fadeOut(200);
        };
    });
};
$(document).ready(function(){
gotoTop();
});
</script>
<section class="quickstart hide-on-mobiles">
  <div class="grid">
    <div class="unit code">
      <p class="title">Search</p>
      <div class="shell">
        <form class="line">
          <div class="input-append">
            <input class="query_input four-fifths" type="search" name="q" id="query_input" placeholder="Enter keywords..."/>
            <button class="query_btn one-fifths" type="button" id="query_btn">Go!</button>
          </div>
        </form>
        <ul id="query_result" class="four-fifths">
        </ul>
      </div>
    </div>
    <div class="clear"></div>
  </div>
</section>
<div id="gotoTop">{{site.t[page.lang].gotoTop}}</div>